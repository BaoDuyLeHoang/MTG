import React, { useState } from "react";
import { Link } from "react-router-dom";
import "./header.css";
import logo from "../../assets/logo/logo-giao-duc-an-nhien.png";
import { useAuth } from "../../context/AuthContext";
import { useNavigate } from 'react-router-dom';
import { FontAwesomeIcon } from '@fortawesome/react-fontawesome';
import { faUser } from '@fortawesome/free-solid-svg-icons';

const Header = () => {
  const [showSettings, setShowSettings] = useState(false);
  const { user, logout } = useAuth(); // Get both user and logout from useAuth
  const navigate = useNavigate();

  const toggleSettings = () => {
    setShowSettings(!showSettings);
  };

  const handleLogout = () => {
    logout(); // Use the logout function from AuthContext
    navigate('/login'); // Redirect to home page after logout
  };

  const displayName = user ? (user.accountName) : "üë§";

  return (
    <header className="header">
      <div className="header-logo">
        <img src={logo} alt="Logo" />
      </div>
      <nav className="navigation">
        <ul>
          <li>
            <Link to="/">Trang ch·ªß</Link>
          </li>
          <li>
            <Link to="/gioi-thieu">Gi·ªõi thi·ªáu</Link>
          </li>
          <li>
            <Link to="/dichvu">D·ªãch v·ª•</Link>
          </li>
          <li>
            <Link to="/tim-kiem-mo">T√¨m ki·∫øm m·ªô</Link>
          </li>
          <li>
            <Link to="/blog-view">B√†i vi·∫øt</Link>
          </li>
        </ul>
      </nav>
      <div className="user-settings">
        <button onClick={toggleSettings} className="user-icon">
          <FontAwesomeIcon icon={faUser} />
        </button>
        {showSettings && (
          <div className="settings-dropdown">
            {user ? (
              <>
                {user.role === 4 && (
                  <>
                    <Link to="/user-profile">H·ªì s∆°</Link>
                    <Link to="/relative-grave">M·ªô ng∆∞·ªùi th√¢n</Link>
                    <Link to="/cart">Gi·ªè h√†ng</Link>
                    <Link to="/order-history">L·ªãch s·ª≠ ƒë∆°n h√†ng</Link>
                  </>
                )}
                {user.role === 2 && (
                  <>
                    <Link to="/manager">V·ªÅ Qu·∫£n l√Ω</Link>
                  </>
                )}
                {user.role === 1 && (
                  <>
                    <Link to="/admin">V·ªÅ Admin</Link>
                  </>
                )}
                {user.role === 3 && (
                  <>
                    <Link to="/staff">V·ªÅ Nh√¢n vi√™n</Link>
                  </>
                )}
                <button onClick={handleLogout} className="logout-link">
                  ƒêƒÉng xu·∫•t
                </button>
              </>
            ) : (
              <>
                <Link to="/cart">Gi·ªè h√†ng</Link>
                <Link to="/login">ƒêƒÉng nh·∫≠p</Link>
              </>
            
            )}
          </div>
        )}
      </div>
    </header>
  );
};

export default Header;
